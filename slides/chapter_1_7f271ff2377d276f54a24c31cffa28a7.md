---
title: Insert title here
key: 7f271ff2377d276f54a24c31cffa28a7

---
## Global and Local Outlier (version 2 with code as requested)

```yaml
type: "TitleSlide"
key: "1dc5783fb9"
```

`@lower_third`

name: Raffaele Miele
title: Head of Data Science - Crisma


`@script`
In the past lessons we discovered that anomaly detection is about looking for outliers in data. We also defined an outlier as a point that is very distant from other points.


---
## remove - Global Vs Local

```yaml
type: "TwoColumns"
key: "b587211e91"
```

`@part1`
Global Outliers

- Very High {{1}}

- Very Low{{2}}

- WRT all other points {{3}}


`@part2`
Local outliers

- in normal range {{4}}

- far from local points {{5}}


`@script`
Now we'll get a little bit deeper in the definition of outlier by describing the differences between the two most important types: global and local outliers. 
As we've seen in the last chapter global outliers are points that have a **v**ery high or a **v**ery low value when compared to **a**ll the other values in a dataset. 
Local outliers, on the contrary, are points that have values within the **n**ormal range for the whole dataset but that are unusually low or high **w**hen compared to the surrounding points.
This means that the same value may not be considered as an outlier in case it occurred in a different context.


---
## Global Outliers

```yaml
type: "FullSlide"
key: "699a147ed8"
```

`@part1`
Values that are: 

- Very High {{1}}

- Very Low{{2}}

- WRT all other points {{3}}


`@script`
Now we'll get a little bit deeper in the definition of outlier by describing the differences between the two most important types: global and local outliers. 
As we've seen in the last chapter global outliers are points that have a **v**ery high or a **v**ery low value when compared to **a**ll the other values in a dataset.


---
## Detecting global outliers: the zscore method

```yaml
type: "FullCodeSlide"
key: "2b52d3c2c2"
```

`@part1`



`@script`
Now let's take a look to some methods to detect global outliers. The first one is calculating z-scores on your dataset. Z-scores method can be summarized as follows: it associates a score to each data point that explains how far it is from the global mean in terms of standard deviation. This definition becomes very clear with a simple example: imagine a temperature dataset with 25 as global mean and 2 as standard deviation. A data point that has a zscore of +2 tells us that such point has a value that is two times the standard deviation (2*2 = 4) higher than the mean (which is 25). So such value must be higher or equal than 29. Similarly when a zscore of -2 tells us that the point has a value equal or smaller than 25 minus 4 (which is 21). Since we are interested in detecting outliers that are either above or below the mean it is practical to look at the absolute value of the zscores.


---
## The zscore() function

```yaml
type: "FullSlide"
key: "0ee08779ef"
```

`@part1`
In the scipy package
```
from scipy import stats
```
Input: an univariate numerical array
```
zscore_data = stats.zscore(data)
```
Output: the associated z-score
```
candidate_outliers_id = np.where(np.abs(zscore_data >= 3))
```


`@script`
The zscore function is performed by the stats subpackage of the scipy package. The zscore function requires an array containing the original data as input. It outputs an array containing all the zscores associated to each original data point. Once we have that we can query our results to find all the data points whose absolute zscore is higher that a certain threshold. Such points can be seen as candidate outliers.


---
## Local Outliers

```yaml
type: "FullSlide"
key: "9b961d85f3"
```

`@part1`
Values that are: 

- in normal range {{1}}

- far from local points {{2}}

- out of context {{3}}


`@script`
Local outliers, on the contrary, are points that have values within the **n**ormal range for the whole dataset but that are unusually low or high **w**hen compared to the surrounding points.
This means that the same value may not be considered as an outlier in case it occurred in a different context.


---
## Local outliers - one variable

```yaml
type: "FullImageSlide"
key: "3da09b06cb"
```

`@part1`
![](https://assets.datacamp.com/production/repositories/3976/datasets/b928709eef331399e258325202345ac50649a300/Slide%203.PNG)


`@script`
To give an example let's look at this temperature dataset. Here data are ordered according by time:


---
## Local outliers - one variable

```yaml
type: "FullImageSlide"
key: "3142e7b51b"
```

`@part1`
![](https://assets.datacamp.com/production/repositories/3976/datasets/2cbe00a1b8d71b48bcbdfb75c34fd2880f73243c/Slide%203_2.PNG)


`@script`
the point marked by the red arrow has a value that is between the maximum minimum range of the whole dataset. This means that, for example, it won't be classified as an outlier in a boxplot.
But if we look at its close observations we find that in that day the temperature was extremely high according to the period. This is an example of a local outlier. 
Local outliers in one or two dimensions can be found by appropriate graphical visualization.


---
## Local outliers - two variables

```yaml
type: "FullImageSlide"
key: "9f5565ec33"
```

`@part1`
![](https://assets.datacamp.com/production/repositories/3976/datasets/8875ee09699161b4a36484eebe92f9efea2c3395/Slide%204.png)


`@script`
In this example we can see a bivariate plot of two continuous variables. Here the scatter plot helps us to identify the anomalous points, which are marked with an X. 
The points marked with a blue X are global outliers since they are  out of the global range. 
The point marked with a black X is a local outlier since it lies inside the range of all the points but it is pretty far from the two dense clusters which are colored in red and green. 
So bivariate local outliers can be identified by looking at scatter plots and extracted in order to be removed or investigated. 
Things get more complicated when the dimensionality grows.


---
## More variables

```yaml
type: "FullImageSlide"
key: "b1d6962912"
```

`@part1`
![](https://assets.datacamp.com/production/repositories/3976/datasets/ba2738be6361ae1843ee3bd97e5067d74f0d1c2c/slide%205.png)


`@script`
Look at this example in which we have a five variables dataset. 
In this case identifying the anomalous statistical units by using plots can be extremely difficult and time consuming. We can go plotting all 2 ways combinations of variables and look at the scatter matrix. As you can see inspecting all those plots it's a lot of work. Moreover the inspection of the 2 ways relations doesn't garantee to detect all the outliers since multidimensional outliers could appear as normal even on all bivariate scatter plots. This is the reason why we need something that would inspect all local multidimensional densities for us. Such objects will be covered in the next chapter. But now let's make some practice about global and local outliers!


---
## More variables

```yaml
type: "TwoColumns"
key: "b28fd4f5e3"
```

`@part1`
Much more difficult.

Something to try: bivariate visual inspection

```
import seaborn as sns
```

```
sns.pairplot(data)
```


`@part2`
![](https://assets.datacamp.com/production/repositories/3976/datasets/ba2738be6361ae1843ee3bd97e5067d74f0d1c2c/slide%205.png)


`@script`
Imagine to have a five variables dataset in which you want to detect outliers. In this case identifying the anomalous statistical units by using plots can be extremely difficult and time consuming. We can go plotting all 2 ways combinations of variables and look at the scatter matrix. This can be accomplished by using the pairs function in the seaborn package. Such function, in its simplest form,  requires a dataframe as input and draws a grid of univariate and bivariate plots. 
As you can see inspecting all those plots it's a lot of work. Moreover the inspection of the 2 ways relations doesn't garantee to detect all the outliers since multidimensional outliers could appear as normal even on all bivariate scatter plots. This is the reason why we need something that would inspect all local multidimensional densities for us. Such objects will be covered in the next chapter. But now let's make some practice about global and local outliers!


---
## Final Slide

```yaml
type: "FinalSlide"
key: "fc89afe5d3"
```

`@script`


